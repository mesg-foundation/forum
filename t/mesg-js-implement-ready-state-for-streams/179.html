<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <title>Mesg-js: implement &#39;ready&#39; state for streams - Library JS - MESG Community</title>
    <meta name="description" content="related with: 

https://github.com/mesg-foundation/mesg-js/pull/49
https://github.com/mesg-foundation/mesg-js/pull/47

With the new high level APIs of application and service clients we don’t have a way of notify users a&amp;hellip;">
    <meta name="generator" content="Discourse 2.5.0.beta5 - https://github.com/discourse/discourse version 00aab498297cba8f977c1e0eb17b7d38ff06cc68">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/9f11b6ddfa02bffdbec79487592a0573a0236cb5_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/53630361a40ad76e1733dd0b0f486e9ae2f4f4d6_2_180x180.png">
<meta name="theme-color" content="#491e8c">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="179.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.mesg.com","potentialAction":{"@type":"SearchAction","target":"https://forum.mesg.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="MESG Community Search">

      <link href="../../stylesheets/desktop_3_52e3411e87658e862890db7bd06899cf49ad5f59.css%3F__ws=forum.mesg.com.css" media="all" rel="stylesheet" data-target="desktop" data-theme-id="7"/>
      <link href="../../stylesheets/desktop_theme_7_bf4f2d3d8a71e6ee907065be9a79df3d849bd29c.css%3F__ws=forum.mesg.com.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="7"/>
    
    <meta id="data-ga-universal-analytics" data-tracking-code="UA-117583862-1" data-json="{&quot;cookieDomain&quot;:&quot;auto&quot;}" data-auto-link-domains="">

<link rel="preload" href="../../assets/google-universal-analytics-00f5cdf7dfd45cba1ae2d258c3366c371c5671023250abbd964a1f16fc2c11a7.js" as="script">
<script src="../../assets/google-universal-analytics-00f5cdf7dfd45cba1ae2d258c3366c371c5671023250abbd964a1f16fc2c11a7.js"></script>


        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Mesg-js: implement &#39;ready&#39; state for streams&#39;" href="179.rss" />
    <meta property="og:site_name" content="MESG Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.mesg.com/uploads/default/original/1X/55dc05831fcfbf2dd0677c9ae39099094e85cc07.png" />
<meta property="og:image" content="https://forum.mesg.com/uploads/default/original/1X/55dc05831fcfbf2dd0677c9ae39099094e85cc07.png" />
<meta property="og:url" content="https://forum.mesg.com/t/mesg-js-implement-ready-state-for-streams/179" />
<meta name="twitter:url" content="https://forum.mesg.com/t/mesg-js-implement-ready-state-for-streams/179" />
<meta property="og:title" content="Mesg-js: implement &#39;ready&#39; state for streams" />
<meta name="twitter:title" content="Mesg-js: implement &#39;ready&#39; state for streams" />
<meta property="og:description" content="related with:   https://github.com/mesg-foundation/mesg-js/pull/49 https://github.com/mesg-foundation/mesg-js/pull/47  With the new high level APIs of application and service clients we don’t have a way of notify users about if the stream is ready for serving task/event/result data.  In the example below, we never know if the stream is ready to serve result data. We can only be sure of that when the first result received. But in order to provide a more consistent API and implement new ack featur..." />
<meta name="twitter:description" content="related with:   https://github.com/mesg-foundation/mesg-js/pull/49 https://github.com/mesg-foundation/mesg-js/pull/47  With the new high level APIs of application and service clients we don’t have a way of notify users about if the stream is ready for serving task/event/result data.  In the example below, we never know if the stream is ready to serve result data. We can only be sure of that when the first result received. But in order to provide a more consistent API and implement new ack featur..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="1 ❤" />
<meta property="article:published_time" content="2019-01-08T08:45:51+00:00" />
<meta property="og:ignore_canonical" content="true" />



    <script type="application/ld+json">{"@context":"http://schema.org","@type":"QAPage","name":"Mesg-js: implement 'ready' state for streams","mainEntity":{"@type":"Question","name":"Mesg-js: implement 'ready' state for streams","text":"related with:\n\n<a href="https://forum.mesg.com/t/mesg-js-implement-ready-state-for-streams/\&quot;https://github.com/mesg-foundation/mesg-js/pull/49\&quot;" rel=\"nofollow noopener\">https://github.com/mesg-foundation/mesg-js/pull/49<\/a>\n\n<a href="https://forum.mesg.com/t/mesg-js-implement-ready-state-for-streams/\&quot;https://github.com/mesg-foundation/mesg-js/pull/47\&quot;" rel=\"nofollow noopener\">https://github.com/mesg-foundation/mesg-js/pull/47<\/a>\n\nWith the new high level APIs of application and service clients we don’t have a way of notify users about if the stream is ready for serving task/event/result data.\n\nIn the example &hellip;","upvoteCount":0,"answerCount":1,"dateCreated":"2019-01-08T08:45:51.461Z","author":{"@type":"Person","name":"İlker"},"acceptedAnswer":{"@type":"Answer","text":"We decided to change public APIs so this proposal is no longer needed.\n\nHowever, I implemented the event version with this <a href="https://forum.mesg.com/t/mesg-js-implement-ready-state-for-streams/\&quot;https://github.com/mesg-foundation/mesg-js/pull/47/commits/2798dbe2e8888ba644c361540d5bc9d37e3c057f\&quot;" rel=\"nofollow noopener\">commit<\/a>. We’ll keep this commit and other updated version of high level APIs in another branch called generated-and-high-level-apis for future attention.","upvoteCount":1,"dateCreated":"2019-01-08T13:06:41.745Z","url":"https://forum.mesg.com/t/mesg-js-implement-ready-state-for-streams/179/2","author":{"@type":"Person","name":"ilgooz"}}}}</script>
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/1X/81100f444852fa77ae7cd5276c5683e9a8cfc9a2.png" alt="MESG Community" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="179.html">Mesg-js: implement &#39;ready&#39; state for streams</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/development.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/development/library-js.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Library JS</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/proposal.html' class='discourse-tag' rel="tag">proposal</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='MESG Foundation'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.mesg.com/uploads/default/original/1X/81100f444852fa77ae7cd5276c5683e9a8cfc9a2.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/ilgooz.html'><span itemprop='name'>ilgooz</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="179.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-01-08T08:45:51Z'>
              <time itemprop='dateModified' datetime='2019-01-08T13:07:12Z' class='post-time'>
                January 8, 2019,  1:07pm
              </time>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>related with:</p>
<ul>
<li><a href="https://github.com/mesg-foundation/mesg-js/pull/49" rel="nofollow noopener">https://github.com/mesg-foundation/mesg-js/pull/49</a></li>
<li><a href="https://github.com/mesg-foundation/mesg-js/pull/47" rel="nofollow noopener">https://github.com/mesg-foundation/mesg-js/pull/47</a></li>
</ul>
<p>With the new high level APIs of application and service clients we don’t have a way of notify users about if the stream is ready for serving <code>task/event/result</code> data.</p>
<p>In the example below, we never know if the stream is ready to serve <em>result</em> data. We can only be sure of that when the first result received. But in order to provide a more consistent API and implement new <em>ack</em> feature, we need to know that stream is ready to serve data so we can execute a task afterwards.</p>
<pre><code class="lang-auto">const stream = app.listenResult({serviceID: "3989b1e17bd5fc4b7fca846141cb8dc4efa6fc64"})
stream.on('result', (e) =&gt; { console.log(e) })
stream.on('end', (e) =&gt; { console.log(e) })
</code></pre>
<p><strong>I propose two solutions for this:</strong></p>
<p>1- introduce ‘ready’ event:</p>
<pre><code class="lang-auto">// note that with this implementation, since we return stream directly with the listenResult() it's possible to cancel the stream easily/anytime by calling stream.cancel()
// with the other option stream cancelation only possible after stream is actually started(ready).
const stream = app.listenResult({serviceID: "3989b1e17bd5fc4b7fca846141cb8dc4efa6fc64"})
stream.on('ready', () =&gt; {  })
stream.on('result', (e) =&gt; { console.log(e) })
stream.on('end', (e) =&gt; { console.log(e) })
</code></pre>
<p>2- or we can accept a callback and inject the stream to it when it’s ready.</p>
<pre><code class="lang-auto">app.listenResult({serviceID: "3989b1e17bd5fc4b7fca846141cb8dc4efa6fc64"}, (stream) =&gt; {
  stream.on('result', (e) =&gt; { console.log(e) })
  stream.on('end', (e) =&gt; { console.log(e) })
})
</code></pre>
<div class="poll" data-poll-status="open" data-poll-public="true" data-poll-results="always" data-poll-type="regular" data-poll-name="poll">
<div>
<div class="poll-container">
<ul>
<li data-poll-option-id="09fba58a5296c7db22bfac271abe7f7d">event</li>
<li data-poll-option-id="6a1d6f88839753646a4125d38cbde7de">callback</li>
</ul>
</div>
<div class="poll-info">
<p>
<span class="info-number">0</span>
<span class="info-label">voters</span>
</p>
</div>
</div>
</div>
        </div>

        <meta itemprop='headline' content='Mesg-js: implement &#39;ready&#39; state for streams'>
          <meta itemprop='keywords' content='proposal'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='MESG Foundation'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.mesg.com/uploads/default/original/1X/81100f444852fa77ae7cd5276c5683e9a8cfc9a2.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../u/ilgooz.html'><span itemprop='name'>ilgooz</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="179.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-01-08T13:06:41Z'>
              <time itemprop='dateModified' datetime='2019-12-26T02:30:54Z' class='post-time'>
                December 26, 2019,  2:30am
              </time>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>We decided to change public APIs so this proposal is no longer needed.</p>
<p>However, I implemented the event version with this <a href="https://github.com/mesg-foundation/mesg-js/pull/47/commits/2798dbe2e8888ba644c361540d5bc9d37e3c057f" rel="nofollow noopener">commit</a>. We’ll keep this commit and other updated version of high level APIs in another branch called <em>generated-and-high-level-apis</em> for future attention.</p>
        </div>

        <meta itemprop='headline' content='Mesg-js: implement &#39;ready&#39; state for streams'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
