<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <title>Improve relation between SID and Hashes - Engine - MESG Community</title>
    <meta name="description" content="After a conversation with @Anthony about the relation between SID and Hashes that we would like to have, we decided a few things. 
Relation between SID and Hashes
The relation between SID and Hashes should keep track of &amp;hellip;">
    <meta name="generator" content="Discourse 2.5.0.beta5 - https://github.com/discourse/discourse version 00aab498297cba8f977c1e0eb17b7d38ff06cc68">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/1X/9f11b6ddfa02bffdbec79487592a0573a0236cb5_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/1X/53630361a40ad76e1733dd0b0f486e9ae2f4f4d6_2_180x180.png">
<meta name="theme-color" content="#491e8c">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../141.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.mesg.com","potentialAction":{"@type":"SearchAction","target":"https://forum.mesg.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="MESG Community Search">

      <link href="../../../stylesheets/desktop_3_52e3411e87658e862890db7bd06899cf49ad5f59.css%3F__ws=forum.mesg.com.css" media="all" rel="stylesheet" data-target="desktop" data-theme-id="7"/>
      <link href="../../../stylesheets/desktop_theme_7_bf4f2d3d8a71e6ee907065be9a79df3d849bd29c.css%3F__ws=forum.mesg.com.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="7"/>
    
    <meta id="data-ga-universal-analytics" data-tracking-code="UA-117583862-1" data-json="{&quot;cookieDomain&quot;:&quot;auto&quot;}" data-auto-link-domains="">

<link rel="preload" href="../../../assets/google-universal-analytics-00f5cdf7dfd45cba1ae2d258c3366c371c5671023250abbd964a1f16fc2c11a7.js" as="script">
<script src="../../../assets/google-universal-analytics-00f5cdf7dfd45cba1ae2d258c3366c371c5671023250abbd964a1f16fc2c11a7.js"></script>


        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Improve relation between SID and Hashes&#39;" href="../141.rss" />
    <meta property="og:site_name" content="MESG Community" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.mesg.com/uploads/default/original/1X/55dc05831fcfbf2dd0677c9ae39099094e85cc07.png" />
<meta property="og:image" content="https://forum.mesg.com/uploads/default/original/1X/55dc05831fcfbf2dd0677c9ae39099094e85cc07.png" />
<meta property="og:url" content="https://forum.mesg.com/t/improve-relation-between-sid-and-hashes/141/2?u=ilgooz" />
<meta name="twitter:url" content="https://forum.mesg.com/t/improve-relation-between-sid-and-hashes/141/2?u=ilgooz" />
<meta property="og:title" content="Improve relation between SID and Hashes" />
<meta name="twitter:title" content="Improve relation between SID and Hashes" />
<meta property="og:description" content="Start &amp; Stop service APIs should reply with the hash to indicate which version of the service started or stopped otherwise it’s ambiguous. (we can also return the sid, can be useful when start/stop made with the hash.)    Running a service with different hashes at the same is needed in real world apps. Think about blue/green deployments where you still need to run the service with the previous version until all reaming tasks complete. (volume issue is an another topic, it shouldn’t limit runni..." />
<meta name="twitter:description" content="Start &amp; Stop service APIs should reply with the hash to indicate which version of the service started or stopped otherwise it’s ambiguous. (we can also return the sid, can be useful when start/stop made with the hash.)    Running a service with different hashes at the same is needed in real world apps. Think about blue/green deployments where you still need to run the service with the previous version until all reaming tasks complete. (volume issue is an another topic, it shouldn’t limit runni..." />
<meta property="article:published_time" content="2018-12-13T09:33:40+00:00" />
<meta property="og:ignore_canonical" content="true" />



    <script type="application/ld+json">{"@context":"http://schema.org","@type":"QAPage","name":"Improve relation between SID and Hashes","mainEntity":{"@type":"Question","name":"Improve relation between SID and Hashes","text":"After a conversation with <a class=\"mention\" href="https://forum.mesg.com/t/improve-relation-between-sid-and-hashes/141/\&quot;/u/anthony\&quot;">@Anthony<\/a> about the relation between SID and Hashes that we would like to have, we decided a few things.\n\nRelation between SID and Hashes\n\nThe relation between SID and Hashes should keep track of all hashes referenced by the SID and preserve the order of addition. So basicall&hellip;","upvoteCount":0,"answerCount":0,"dateCreated":"2018-12-13T09:02:12.281Z","author":{"@type":"Person","name":"Nicolas"}}}</script>
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/1X/81100f444852fa77ae7cd5276c5683e9a8cfc9a2.png" alt="MESG Community" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../141.html">Improve relation between SID and Hashes</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../../c/development.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../../c/development/engine.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Engine</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../../tag/proposal.html' class='discourse-tag' rel="tag">proposal</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='MESG Foundation'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.mesg.com/uploads/default/original/1X/81100f444852fa77ae7cd5276c5683e9a8cfc9a2.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../../u/Nicolas.html'><span itemprop='name'>Nicolas</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../141.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-12-13T09:02:12Z' class='post-time'>
                December 13, 2018,  9:02am
              </time>
              <meta itemprop='dateModified' content='2018-12-13T09:02:12Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>After a conversation with <a class="mention" href="../../../u/anthony.html">@Anthony</a> about the relation between SID and Hashes that we would like to have, we decided a few things.</p>
<h1>Relation between SID and Hashes</h1>
<p>The relation between SID and Hashes should keep track of all hashes referenced by the SID and preserve the order of addition. So basically, in the database, SID should reference an array of hash.</p>
<h1>Service Deployment</h1>
<p>Deploying a service with an existing SID will <strong>not</strong> delete existing services but only append the new service’s hash to the associated SID array of hashes. Like this, it keeps existing services with the order of deployment.</p>
<h1>Return a service from a SID</h1>
<p>When a service needs to be returned from a SID, the most recent deployed service will be returned.</p>
<h1>Prevent concurrent run of services with same ID</h1>
<p>Because of volumes, services with the same SID cannot run at the same time. The function service start have to prevent this behavior and fail with a explicit error for the user.</p>
<h1>Delete a SID</h1>
<p>When users want to delete a service with a hash, the hash is removed from the SID’s array of hashes as well as the corresponding service.<br>
When users want to delete a service with a SID, the last deployed service’s hash is removed from the SID’s array of hashes as well as the corresponding service.</p>
<p>In both case, if there is no more element in the SID’s array of hashes, then the SID’s array of hashes must be remove from the database.</p>
<hr>
<p><a class="mention" href="../../../u/krhubert.html">@krhubert</a> <a class="mention" href="../../../u/ilgooz.html">@ilgooz</a> <a class="mention" href="../../../u/anthony.html">@Anthony</a> what do you think about this? do you have feedback?</p>
        </div>

        <meta itemprop='headline' content='Improve relation between SID and Hashes'>
          <meta itemprop='keywords' content='proposal'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='MESG Foundation'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.mesg.com/uploads/default/original/1X/81100f444852fa77ae7cd5276c5683e9a8cfc9a2.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../../u/ilgooz.html'><span itemprop='name'>ilgooz</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../141.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2018-12-13T09:33:40Z'>
              <time itemprop='dateModified' datetime='2018-12-13T09:39:49Z' class='post-time'>
                December 13, 2018,  9:39am
              </time>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <ul>
<li>
<p><a href="https://github.com/mesg-foundation/core/blob/2cd3fa0/protobuf/coreapi/api.proto#L208" rel="nofollow noopener">Start</a> &amp; Stop service APIs should reply with the hash to indicate which version of the service started or stopped otherwise it’s ambiguous. (we can also return the sid, can be useful when start/stop made with the hash.)</p>
</li>
<li>
<p>Running a service with different hashes at the same is needed in real world apps. Think about blue/green deployments where you still need to run the service with the previous version until all reaming tasks complete. (volume issue is an another topic, it shouldn’t limit running a service’s multiple versions at the same time.)</p>
</li>
<li>
<p>[feature idea]: introduce a lock file to workflows to lock versions of services.</p>
</li>
</ul>
<p>other than these lgtm. <img src="../../../images/emoji/twitter/+1.png%3Fv=6" title=":+1:" class="emoji" alt=":+1:"></p>
        </div>

        <meta itemprop='headline' content='Improve relation between SID and Hashes'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                    <a href="../../introducing-workflow-files/95/12.html" itemprop='item'>
                      <meta itemprop='url' content='https://forum.mesg.com/t/introducing-workflow-files/95/12'>
                      <meta itemprop='position' content='2'>
                      <span itemprop='name'>Introducing Workflow Files</span>
                    </a>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='MESG Foundation'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.mesg.com/uploads/default/original/1X/81100f444852fa77ae7cd5276c5683e9a8cfc9a2.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../../u/Anthony.html'><span itemprop='name'>Anthony</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../141.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-12-13T09:58:02Z' class='post-time'>
                December 13, 2018,  9:58am
              </time>
              <meta itemprop='dateModified' content='2018-12-13T09:58:02Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Ok for me but still need some discussion about:</p>
<h3>Prevent concurrent run of services with same ID</h3>
<p>Not sure this is really necessary, again responsibility of the developer.<br>
Agree with <a class="mention" href="../../../u/ilgooz.html">@ilgooz</a>, we can return the list of service ids/hash that are running like that when the developer run a new service (s)he can then see the list of similar services that are running and if (s)he don’t want to run to (s)he can stop it.<br>
Let’s not enforce anything here but just provide the informations to revert if needed.</p>
<h3>Delete a SID</h3>
<p>I’m not really agree with the part “When users want to delete a service with a SID, the last deployed service’s hash is removed”. If I compare with shared pointers, has_many relationships in a database or any linked resources. When an attached resource is delete then fine but when the resource that attach everything is deleted then everything is deleted.<br>
So here when the sid is deleted all the attached hash should be deleted. This is a “risky” operation and that’s the responsibility of the developer. If they do mistakes they can re-deploy it.</p>
<p>Other than that it’s good</p>
        </div>

        <meta itemprop='headline' content='Improve relation between SID and Hashes'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='MESG Foundation'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forum.mesg.com/uploads/default/original/1X/81100f444852fa77ae7cd5276c5683e9a8cfc9a2.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='../../../u/Nicolas.html'><span itemprop='name'>Nicolas</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../141.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2018-12-13T11:47:25Z'>
              <time itemprop='dateModified' datetime='2018-12-13T11:48:11Z' class='post-time'>
                December 13, 2018, 11:48am
              </time>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Note from a conversation on the Chat:</p>
<p>SID is also used for generating the name of the volume.<br>
Maybe it’s not the best solution and makes things more complicated (like what happen if 2 services with the same SID runs at the same time with the same volumes?).</p>
<p><a class="mention" href="../../../u/ilgooz.html">@ilgooz</a> suggested to add a developer defined key to the volumes. Eg:</p>
<pre><code class="lang-auto">volumes:
  - very-unique-volume:/var/lib
</code></pre>
        </div>

        <meta itemprop='headline' content='Improve relation between SID and Hashes'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
